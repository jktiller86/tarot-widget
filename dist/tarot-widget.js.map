{"version":3,"file":"tarot-widget.js","sources":["../src/components/TarotCardWidget.tsx","../src/mount.tsx"],"sourcesContent":["// src/components/TarotCardWidget.tsx\nimport React, { useState, useEffect, FormEvent } from 'react';\nimport { motion } from 'framer-motion';\n\ninterface Card {\n  number: number;\n  url: string;\n}\n\ninterface Props {\n  subscribeEndpoint: string;\n}\n\nconst COVER_URL =\n  'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a124b1a11a779600fb94_Cover.jpg';\n\nconst cards: Card[] = [\n  { number: 1, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbcdf8/6837a123832438a378bbcdf8_01.jpg' },\n  { number: 2, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a1234d1200b08de1c01f_02.jpg' },\n  { number: 3, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a123b1a11a779600fa88_03.jpg' },\n  { number: 4, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a1234dc40f413a7af36d_04.jpg' },\n  { number: 5, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a1236162caf82d36eb95_05.jpg' },\n  { number: 6, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a1236bc543b6e36ace9f_06.jpg' },\n  { number: 7, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a1234dc40f413a7af371_07.jpg' },\n  { number: 8, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a123a3e295a38760f1c8_08.jpg' },\n  { number: 9, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a12366615a6d9df7f7f8_09.jpg' },\n  { number: 10, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a12385654504f913473b_10.jpg' },\n  { number: 11, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a1233bfe284ebd489faf_11.jpg' },\n  { number: 12, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a12327c38ba1f2678d26_12.jpg' },\n  { number: 13, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a123936359963d0588f1_13.jpg' },\n  { number: 14, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a123a38bc135fdca926b_14.jpg' },\n  { number: 15, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a123a47a74cd5b88126b_15.jpg' },\n  { number: 16, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a1240a1d5c1664c1737e_16.jpg' },\n  { number: 17, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a123ccb2139df0446b49_17.jpg' },\n  { number: 18, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a1240a1d5c1664c17392_18.jpg' },\n  { number: 19, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a123d6be3ee12d063e5e_19.jpg' },\n  { number: 20, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a124a45d9392ce70797a_20.jpg' },\n  { number: 21, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a123ff082011cf44220b_21.jpg' },\n  { number: 22, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a124ead8cf6533c45891_22.jpg' },\n  { number: 23, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a124d3cbc65f78bbf26f_23.jpg' },\n  { number: 24, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a124a38bc135fdca92b7_24.jpg' },\n  { number: 25, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a124a3e295a38760f2e5_25.jpg' },\n  { number: 26, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a1240bcfe07db2bed686_26.jpg' },\n  { number: 27, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a124ff082011cf44225f_27.jpg' },\n  { number: 28, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a124cfa86f7c422ffeed_28.jpg' },\n  { number: 29, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a124a38bc135fdca9326_29.jpg' },\n  { number: 30, url: 'https://cdn.prod.website-files.com/68379778f107ba359adbbfe8/6837a124c6d9eb99f2692c64_30.jpg' },\n];\n\nconst TarotCardWidget: React.FC<Props> = ({ subscribeEndpoint }) => {\n  const [currentCard, setCurrentCard] = useState<Card | null>(null);\n  const [step, setStep] = useState<'idle' | 'shuffle' | 'flip' | 'form'>('idle');\n  const [status, setStatus] = useState<'idle' | 'loading' | 'success' | 'error'>('idle');\n  const isFlipped = step === 'flip' || step === 'form';\n\n  const draw = () => {\n    if (step === 'idle' || step === 'form') {\n      const next = cards[Math.floor(Math.random() * cards.length)];\n      setCurrentCard(next);\n      setStep('shuffle');\n      setStatus('idle');\n    }\n  };\n\n  useEffect(() => {\n    if (step === 'shuffle') {\n      const t1 = setTimeout(() => setStep('flip'), 2000);\n      return () => clearTimeout(t1);\n    }\n  }, [step]);\n\n  useEffect(() => {\n    if (step === 'flip') {\n      const t2 = setTimeout(() => setStep('form'), 800);\n      return () => clearTimeout(t2);\n    }\n  }, [step]);\n\n  const handleSubmit = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!currentCard) return;\n\n    const form = e.target as HTMLFormElement;\n    const name = (form.elements.namedItem('name') as HTMLInputElement).value;\n    const email = (form.elements.namedItem('email') as HTMLInputElement).value;\n\n    setStatus('loading');\n    try {\n      const res = await fetch(subscribeEndpoint, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          name,\n          email,\n          cardNumber: currentCard.number,\n        }),\n      });\n      const json = await res.json();\n      if (res.ok && json.success) {\n        setStatus('success');\n      } else {\n        console.error(json);\n        setStatus('error');\n      }\n    } catch (err) {\n      console.error(err);\n      setStatus('error');\n    }\n  };\n\n  return (\n    <div style={{ maxWidth: 600, margin: '0 auto', textAlign: 'center' }}>\n      <p style={{ color: '#666', marginBottom: 20 }}>Click the deck to draw your card</p>\n      <div onClick={draw} style={{ cursor: 'pointer', perspective: 1000, marginBottom: 20 }}>\n        <div style={{ position: 'relative', width: 280, height: 420, margin: '0 auto' }}>\n          {[0, 1, 2].map((_, i) => {\n            const backImage = COVER_URL;\n            const frontImage =\n              i === 0 && isFlipped && currentCard ? currentCard.url : COVER_URL;\n            return (\n              <motion.div\n                key={i}\n                animate={\n                  step === 'shuffle'\n                    ? {\n                        x: [0, -30, 40, -20, 30, 0],\n                        y: [0, -20, -10, -15, -5, 0],\n                        rotate: [0, -5, 3, -2, 4, 0],\n                      }\n                    : { rotateY: isFlipped ? 180 : 0 }\n                }\n                transition={{\n                  duration: step === 'shuffle' ? 2 : 0.8,\n                  ease: 'easeInOut',\n                  delay: step === 'shuffle' ? i * 0.1 : 0,\n                }}\n                style={{\n                  position: 'absolute',\n                  width: '100%',\n                  height: '100%',\n                  transformStyle: 'preserve-3d',\n                  zIndex: 3 - i,\n                }}\n              >\n                {/* back */}\n                <div\n                  style={{\n                    position: 'absolute',\n                    width: '100%',\n                    height: '100%',\n                    backfaceVisibility: 'hidden',\n                    borderRadius: 12,\n                    boxShadow: '0 4px 8px rgba(0,0,0,0.1)',\n                    background: `url(${backImage}) center/cover no-repeat`,\n                  }}\n                />\n                {/* front */}\n                <div\n                  style={{\n                    position: 'absolute',\n                    width: '100%',\n                    height: '100%',\n                    backfaceVisibility: 'hidden',\n                    transform: 'rotateY(180deg)',\n                    borderRadius: 12,\n                    boxShadow: '0 4px 8px rgba(0,0,0,0.1)',\n                    background: `url(${frontImage}) center/cover no-repeat`,\n                  }}\n                />\n              </motion.div>\n            );\n          })}\n        </div>\n      </div>\n\n      {step === 'form' && (\n        <form\n          onSubmit={handleSubmit}\n          style={{\n            background: '#f5f5f5',\n            padding: 20,\n            borderRadius: 12,\n            marginTop: 20,\n            textAlign: 'left',\n            maxWidth: 280,\n            margin: '20px auto',\n          }}\n        >\n          <input\n            name=\"name\"\n            type=\"text\"\n            placeholder=\"Your Name\"\n            required\n            style={{\n              width: '100%',\n              padding: 10,\n              fontSize: 16,\n              borderRadius: 6,\n              border: '1px solid #ddd',\n              marginBottom: 12,\n            }}\n          />\n          <input\n            name=\"email\"\n            type=\"email\"\n            placeholder=\"Your Email\"\n            required\n            style={{\n              width: '100%',\n              padding: 10,\n              fontSize: 16,\n              borderRadius: 6,\n              border: '1px solid #ddd',\n              marginBottom: 12,\n            }}\n          />\n          <button\n            type=\"submit\"\n            style={{\n              width: '100%',\n              background: '#333',\n              color: '#fff',\n              padding: 12,\n              fontSize: 16,\n              border: 'none',\n              borderRadius: 6,\n              cursor: 'pointer',\n            }}\n          >\n            Get My Reading\n          </button>\n        </form>\n      )}\n\n      {/* status messages */}\n      {status === 'loading' && <p>Sending…</p>}\n      {status === 'success' && <p style={{ color: 'green' }}>✅ Check your email soon!</p>}\n      {status === 'error' && <p style={{ color: 'red' }}>❌ Something went wrong.</p>}\n\n      {/* draw again */}\n      {step === 'form' && (\n        <button\n          onClick={draw}\n          style={{\n            marginTop: 16,\n            background: '#333',\n            color: '#fff',\n            padding: '12px 30px',\n            fontSize: 16,\n            border: 'none',\n            borderRadius: 6,\n            cursor: 'pointer',\n          }}\n        >\n          Draw Another Card\n        </button>\n      )}\n    </div>\n  );\n};\n\nexport default TarotCardWidget;\n","// src/mount.tsx\nimport React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport TarotCardWidget from './components/TarotCardWidget';\n\ntype InitOptions = {\n  root: string;              // CSS selector for mount point\n  subscribeEndpoint: string; // your Netlify function URL\n};\n\nexport function init(options: InitOptions) {\n  const el = document.querySelector(options.root);\n  if (!el) {\n    console.warn('[TarotCardWidget] root element not found:', options.root);\n    return;\n  }\n  const root = createRoot(el as HTMLElement);\n  root.render(<TarotCardWidget subscribeEndpoint={options.subscribeEndpoint} />);\n}\n\n// expose to window\n;(window as any).TarotCardWidget = { init };\n"],"names":["COVER_URL","cards","number","url","TarotCardWidget","_ref","subscribeEndpoint","currentCard","setCurrentCard","useState","step","setStep","status","setStatus","isFlipped","draw","next","Math","floor","random","length","useEffect","t1","setTimeout","clearTimeout","t2","_jsxs","style","maxWidth","margin","textAlign","children","_jsx","color","marginBottom","onClick","cursor","perspective","jsx","position","width","height","map","_","i","frontImage","motion","div","animate","x","y","rotate","rotateY","transition","duration","ease","delay","transformStyle","zIndex","backfaceVisibility","borderRadius","boxShadow","background","transform","onSubmit","e","preventDefault","Promise","resolve","form","target","name","elements","namedItem","value","email","_temp","fetch","method","headers","body","JSON","stringify","cardNumber","then","res","json","ok","success","console","error","_catch","err","reject","padding","marginTop","type","placeholder","required","fontSize","border","init","options","el","document","querySelector","root","createRoot","render","warn","window"],"mappings":"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"}